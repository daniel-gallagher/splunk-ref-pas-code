<form script="summary.js" stylesheet="summary.css,tagmanager.css">
    <label>Summary</label>
    <search id="base_search">
        <query>
            | pivot ri_pas_datamodel Root_Event count(Root_Event) AS Count SPLITROW _time AS _time PERIOD auto SPLITROW user AS user SPLITROW command AS command SPLITROW object AS object FILTER command isNotNull $filter$ $exclude$ ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 0 SHOWOTHER 1
        </query>
    </search>
    <fieldset autoRun="true" submitButton="false">
        <input id="timerange" type="time" searchWhenChanged="true">
            <default>
                <earliestTime>-24h</earliestTime>
                <latestTime>now</latestTime>
            </default>
        </input>
    </fieldset>
    <row>
        <html>
            <div class="filter_tags">
                <h3>Filter Criteria:</h3>
                <input id="filter_tags_input" type="text"/>
            </div>
        </html>
    </row>
    <row>
        <panel id="policy_violations_panel">
            <html>
                <h3>Policy Violations</h3>
                <div class="donut_series"></div>
            </html>
        </panel>
        <panel id="policy_single_panel">
            <single id="policy_single">
                <title>Policy Violations</title>
                <searchString>| pivot ri_pas_datamodel Policy_Violation count(Policy_Violation) AS count FILTER command isNotNull $filter$ $exclude$ ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 0 SHOWOTHER 1</searchString>
                <option name="beforeLabel">Policy Violations:</option>
            </single>
        </panel>
    </row>
    <row>
        <chart id="trend_chart">
            <title>Trend</title>
            <searchString>| pivot ri_pas_datamodel Root_Event count(Root_Event) AS count SPLITROW _time AS _time PERIOD auto SPLITCOL command FILTER command isNotNull $filter$ $exclude$ SORT 0 _time ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 10 SHOWOTHER 0</searchString>
            <option name="charting.chart">column</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="drilldown">none</option>
        </chart>
    </row>
    <row id="filter_header">
        <html>
            <h3>Tables Below Filtered on Event Type of $command$</h3>
            <div style="float: right; margin-top: -5px;">
                <button id="reset_filter" class="btn btn-primary">Remove Filter</button>
            </div>
        </html>
    </row>
    <row>
        <table id="user_table">
            <title>Top Users</title>
            <search id="top_users_search" base="base_search">
                <query>stats count by user | sort - count</query>
            </search>
        </table>
        <table id="document_table">
            <title>Top Documents</title>
            <search id="top_documents_search" base="base_search">
                <query>stats count by object | sort - count</query>
            </search>
        </table>
    </row>
</form>