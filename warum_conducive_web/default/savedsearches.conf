[summary_base_search]
search = | pivot ri_pas_datamodel Root_Event count(Root_Event) AS "Count" SPLITROW _time AS _time PERIOD auto SPLITROW user AS user SPLITROW command AS command SPLITROW object AS object FILTER command isNotNull ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 0 SHOWOTHER 1

[trend_chart_search]
search = | pivot ri_pas_datamodel Root_Event count(Root_Event) AS "count(Root_Event)" SPLITROW _time AS _time PERIOD auto SPLITCOL command FILTER command isNotNull SORT 0 _time ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 10 SHOWOTHER 0

[offhours_document_access]
search = index=warum sourcetype="ri:pas:application" | lookup employee_details user OUTPUT shift_start shift_end workdays | eval hour = tonumber(strftime(_time,"%H")) | eval overnight = if(shift_start>shift_end,1,0) | eval valid_time=if((overnight==1 AND (hour >= shift_start OR hour <= shift_end)) OR (overnight==0 AND hour>=shift_start AND hour<shift_end),1,0) | eval shiftday=if(overnight==1 AND hour < shift_end,relative_time(_time,"-1d"),_time) | eval weekday = strftime(_time,"%a") | eval shiftday=strftime(shiftday,"%a") | eval valid_day=if(match(workdays,shiftday),1,0) | search valid_time=0 OR valid_day=0 | bucket _time span=5m | stats count by _time user command object

[recently_terminated_employees]
search = | inputlookup employee_details | search status="terminated" | convert timeformat="%m/%d/%Y" mktime(date) as _time | stats earliest(_time) as earliest by user | eval "Termination Date" = strftime(earliest,"%+")