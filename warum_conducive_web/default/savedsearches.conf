[summary_base_search]
search = | pivot ri_pas_datamodel Root_Event count(Root_Event) AS "Count" SPLITROW _time AS _time PERIOD auto SPLITROW user AS user SPLITROW command AS command SPLITROW object AS object ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 0 SHOWOTHER 1

[trend_chart_search]
search = | pivot ri_pas_datamodel Root_Event count(Root_Event) AS "count(Root_Event)" SPLITROW _time AS _time PERIOD auto SPLITCOL command SORT 0 _time ROWSUMMARY 0 COLSUMMARY 0 NUMCOLS 10 SHOWOTHER 1

[offhours_document_access]
search = index=warum sourcetype="ri:pas:application" | lookup employee_details empusername as user OUTPUT empshiftstarttime empshiftendtime empshiftdays | eval hour = tonumber(strftime(_time,"%H")) | eval overnight = if(empshiftstarttime>empshiftendtime,1,0) | eval valid_time=if((overnight==1 AND (hour >= empshiftstarttime OR hour <= empshiftendtime)) OR (overnight==0 AND hour>=empshiftstarttime AND hour<empshiftendtime),1,0) | eval shiftday=if(overnight==1 AND hour < empshiftendtime,relative_time(_time,"-1d"),_time) | eval weekday = strftime(_time,"%a") | eval shiftday=strftime(shiftday,"%a") | eval valid_day=if(match(empshiftdays,shiftday),1,0) | search valid_time=0 OR valid_day=0 | bucket _time span=5m | stats count by _time user command object